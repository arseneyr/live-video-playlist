/* esm.sh - esbuild bundle(hls-parser@0.10.4) deno production */
import  { Buffer as __Buffer$ } from "https://deno.land/std@0.137.0/node/buffer.ts";var jt=Object.create;var Gt=Object.defineProperty;var xt=Object.getOwnPropertyDescriptor;var qt=Object.getOwnPropertyNames;var Wt=Object.getPrototypeOf,Qt=Object.prototype.hasOwnProperty;var _t=(nt,z)=>()=>(z||nt((z={exports:{}}).exports,z),z.exports);var $t=(nt,z,at,rt)=>{if(z&&typeof z=="object"||typeof z=="function")for(let x of qt(z))!Qt.call(nt,x)&&x!==at&&Gt(nt,x,{get:()=>z[x],enumerable:!(rt=xt(z,x))||rt.enumerable});return nt};var Ht=(nt,z,at)=>(at=nt!=null?jt(Wt(nt)):{},$t(z||!nt||!nt.__esModule?Gt(at,"default",{value:nt,enumerable:!0}):at,nt));var Vt=_t((bt,Yt)=>{(function(nt,z){typeof bt=="object"&&typeof Yt=="object"?Yt.exports=z():typeof define=="function"&&define.amd?define([],z):typeof bt=="object"?bt.HLS=z():nt.HLS=z()})(self,function(){return nt={851:(at,rt,x)=>{var W=x(771),K=W.getOptions,j=W.setOptions,Z=x(463),l=x(367),r=x(890);at.exports={parse:Z,stringify:l,types:r,getOptions:K,setOptions:j}},463:(at,rt,x)=>{function W(n,a){return function(I){if(Array.isArray(I))return I}(n)||function(I,u){if(typeof Symbol<"u"&&Symbol.iterator in Object(I)){var N=[],R=!0,S=!1,A=void 0;try{for(var E,P=I[Symbol.iterator]();!(R=(E=P.next()).done)&&(N.push(E.value),!u||N.length!==u);R=!0);}catch(y){S=!0,A=y}finally{try{R||P.return==null||P.return()}finally{if(S)throw A}}return N}}(n,a)||j(n,a)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function K(n,a){var I;if(typeof Symbol>"u"||n[Symbol.iterator]==null){if(Array.isArray(n)||(I=j(n))||a&&n&&typeof n.length=="number"){I&&(n=I);var u=0,N=function(){};return{s:N,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(E){throw E},f:N}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var R,S=!0,A=!1;return{s:function(){I=n[Symbol.iterator]()},n:function(){var E=I.next();return S=E.done,E},e:function(E){A=!0,R=E},f:function(){try{S||I.return==null||I.return()}finally{if(A)throw R}}}}function j(n,a){if(n){if(typeof n=="string")return Z(n,a);var I=Object.prototype.toString.call(n).slice(8,-1);return I==="Object"&&n.constructor&&(I=n.constructor.name),I==="Map"||I==="Set"?Array.from(n):I==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(I)?Z(n,a):void 0}}function Z(n,a){(a==null||a>n.length)&&(a=n.length);for(var I=0,u=new Array(a);I<a;I++)u[I]=n[I];return u}var l=x(771),r=x(890),d=r.Rendition,T=r.Variant,D=r.SessionData,m=r.Key,b=r.MediaInitializationSection,Y=r.DateRange,V=r.SpliceInfo,w=r.MasterPlaylist,ot=r.MediaPlaylist,g=r.Segment,i=r.PartialSegment,p=r.PrefetchSegment,f=r.RenditionReport;function c(n){return l.trim(n,'"')}function U(n){var a=l.splitAt(n,",");return{duration:l.toNumber(a[0]),title:decodeURIComponent(escape(a[1]))}}function G(n){var a=l.splitAt(n,"@");return{length:l.toNumber(a[0]),offset:a[1]?l.toNumber(a[1]):-1}}function H(n){var a=l.splitAt(n,"x");return{width:l.toNumber(a[0]),height:l.toNumber(a[1])}}function q(n){var a="ALLOWED-CPC: Each entry must consit of KEYFORMAT and Content Protection Configuration",I=n.split(",");I.length===0&&l.INVALIDPLAYLIST(a);var u,N=[],R=K(I);try{for(R.s();!(u=R.n()).done;){var S=u.value,A=W(l.splitAt(S,":"),2),E=A[0],P=A[1];E&&P?N.push({format:E,cpcList:P.split("/")}):l.INVALIDPLAYLIST(a)}}catch(y){R.e(y)}finally{R.f()}return N}function _(n){return n.startsWith('"')?c(n):n.startsWith("0x")||n.startsWith("0X")?l.hexToByteSequence(n):l.toNumber(n)}function k(n,a){a.IV&&n.compatibleVersion<2&&(n.compatibleVersion=2),(a.KEYFORMAT||a.KEYFORMATVERSIONS)&&n.compatibleVersion<5&&(n.compatibleVersion=5)}function J(n){var a,I,u,N={},R=K(l.splitByCommaWithPreservingQuotes(n));try{for(R.s();!(a=R.n()).done;){var S=a.value,A=W(l.splitAt(S,"="),2),E=A[0],P=A[1],y=c(P);switch(E){case"URI":N[E]=y;break;case"START-DATE":case"END-DATE":N[E]=new Date(y);break;case"IV":N[E]=(I=y,u=void 0,(u=l.hexToByteSequence(I)).length!==16&&l.INVALIDPLAYLIST("IV must be a 128-bit unsigned integer"),u);break;case"BYTERANGE":N[E]=G(y);break;case"RESOLUTION":N[E]=H(y);break;case"ALLOWED-CPC":N[E]=q(y);break;case"END-ON-NEXT":case"DEFAULT":case"AUTOSELECT":case"FORCED":case"PRECISE":case"CAN-BLOCK-RELOAD":case"INDEPENDENT":case"GAP":N[E]=y==="YES";break;case"DURATION":case"PLANNED-DURATION":case"BANDWIDTH":case"AVERAGE-BANDWIDTH":case"FRAME-RATE":case"TIME-OFFSET":case"CAN-SKIP-UNTIL":case"HOLD-BACK":case"PART-HOLD-BACK":case"PART-TARGET":case"BYTERANGE-START":case"BYTERANGE-LENGTH":case"LAST-MSN":case"LAST-PART":case"SKIPPED-SEGMENTS":case"SCORE":N[E]=l.toNumber(y);break;default:E.startsWith("SCTE35-")?N[E]=l.hexToByteSequence(y):E.startsWith("X-")?N[E]=_(P):(E==="VIDEO-RANGE"&&y!=="SDR"&&y!=="HLG"&&y!=="PQ"&&l.INVALIDPLAYLIST('VIDEO-RANGE: unknown value "'.concat(y,'"')),N[E]=y)}}}catch(M){R.e(M)}finally{R.f()}return N}function ct(){l.INVALIDPLAYLIST("The file contains both media and master playlist tags.")}function lt(n,a,I){var u,N=(u=a.attributes,new d({type:u.TYPE,uri:u.URI,groupId:u["GROUP-ID"],language:u.LANGUAGE,assocLanguage:u["ASSOC-LANGUAGE"],name:u.NAME,isDefault:u.DEFAULT,autoselect:u.AUTOSELECT,forced:u.FORCED,instreamId:u["INSTREAM-ID"],characteristics:u.CHARACTERISTICS,channels:u.CHANNELS})),R=n[l.camelify(I)],S=function(A,E){var P,y=!1,M=K(A);try{for(M.s();!(P=M.n()).done;){var L=P.value;if(L.name===E.name)return"All EXT-X-MEDIA tags in the same Group MUST have different NAME attributes.";L.isDefault&&(y=!0)}}catch(Q){M.e(Q)}finally{M.f()}return y&&E.isDefault?"EXT-X-MEDIA A Group MUST NOT have more than one member with a DEFAULT attribute of YES.":""}(R,N);S&&l.INVALIDPLAYLIST(S),R.push(N),N.isDefault&&(n.currentRenditions[l.camelify(I)]=R.length-1)}function e(n,a,I,u,N){var R,S=new T({uri:I,bandwidth:a.BANDWIDTH,averageBandwidth:a["AVERAGE-BANDWIDTH"],score:a.SCORE,codecs:a.CODECS,resolution:a.RESOLUTION,frameRate:a["FRAME-RATE"],hdcpLevel:a["HDCP-LEVEL"],allowedCpc:a["ALLOWED-CPC"],videoRange:a["VIDEO-RANGE"],stableVariantId:a["STABLE-VARIANT-ID"]}),A=K(n);try{for(A.s();!(R=A.n()).done;){var E=R.value;if(E.name==="EXT-X-MEDIA"){var P=E.attributes,y=P.TYPE;if(y&&P["GROUP-ID"]||l.INVALIDPLAYLIST("EXT-X-MEDIA TYPE attribute is REQUIRED."),a[y]===P["GROUP-ID"]&&(lt(S,E,y),y==="CLOSED-CAPTIONS")){var M,L=K(S.closedCaptions);try{for(L.s();!(M=L.n()).done;){var Q=M.value.instreamId;if(Q&&Q.startsWith("SERVICE")&&N.compatibleVersion<7){N.compatibleVersion=7;break}}}catch(h){L.e(h)}finally{L.f()}}}}}catch(h){A.e(h)}finally{A.f()}return function(h,tt,F){for(var st=function(){var ut=et[B];ut==="CLOSED-CAPTIONS"&&h[ut]==="NONE"?(F.isClosedCaptionsNone=!0,tt.closedCaptions=[]):h[ut]&&!tt[l.camelify(ut)].some(function(Tt){return Tt.groupId===h[ut]})&&l.INVALIDPLAYLIST("".concat(ut," attribute MUST match the value of the GROUP-ID attribute of an EXT-X-MEDIA tag whose TYPE attribute is ").concat(ut,"."))},B=0,et=["AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS"];B<et.length;B++)st()}(a,S,N),S.isIFrameOnly=u,S}function t(n,a){if(n.method!==a.method||n.uri!==a.uri)return!1;if(n.iv){if(!a.iv||n.iv.length!==a.iv.length)return!1;for(var I=0;I<n.iv.length;I++)if(n.iv[I]!==a.iv[I])return!1}else if(a.iv)return!1;return n.format===a.format&&n.formatVersion===a.formatVersion}function o(n,a,I,u,N,R,S){for(var A=new g({uri:a,mediaSequenceNumber:N,discontinuitySequence:R}),E=!1,P=!1,y=I;y<=u;y++){var M=n[y],L=M.name,Q=M.value,h=M.attributes;if(L==="EXTINF")!Number.isInteger(Q.duration)&&S.compatibleVersion<3&&(S.compatibleVersion=3),Math.round(Q.duration)>S.targetDuration&&l.INVALIDPLAYLIST("EXTINF duration, when rounded to the nearest integer, MUST be less than or equal to the target duration"),A.duration=Q.duration,A.title=Q.title;else if(L==="EXT-X-BYTERANGE")S.compatibleVersion<4&&(S.compatibleVersion=4),A.byterange=Q;else if(L==="EXT-X-DISCONTINUITY")A.parts.length>0&&l.INVALIDPLAYLIST("EXT-X-DISCONTINUITY must appear before the first EXT-X-PART tag of the Parent Segment."),A.discontinuity=!0;else if(L==="EXT-X-KEY")A.parts.length>0&&l.INVALIDPLAYLIST("EXT-X-KEY must appear before the first EXT-X-PART tag of the Parent Segment."),k(S,h),A.key=new m({method:h.METHOD,uri:h.URI,iv:h.IV,format:h.KEYFORMAT,formatVersion:h.KEYFORMATVERSIONS});else if(L==="EXT-X-MAP")A.parts.length>0&&l.INVALIDPLAYLIST("EXT-X-MAP must appear before the first EXT-X-PART tag of the Parent Segment."),S.compatibleVersion<5&&(S.compatibleVersion=5),S.hasMap=!0,A.map=new b({uri:h.URI,byterange:h.BYTERANGE});else if(L==="EXT-X-PROGRAM-DATE-TIME")A.programDateTime=Q;else if(L==="EXT-X-DATERANGE"){for(var tt={},F=0,st=Object.keys(h);F<st.length;F++){var B=st[F];(B.startsWith("SCTE35-")||B.startsWith("X-"))&&(tt[B]=h[B])}A.dateRange=new Y({id:h.ID,classId:h.CLASS,start:h["START-DATE"],end:h["END-DATE"],duration:h.DURATION,plannedDuration:h["PLANNED-DURATION"],endOnNext:h["END-ON-NEXT"],attributes:tt})}else if(L==="EXT-X-CUE-OUT")A.markers.push(new V({type:"OUT",duration:h&&h.DURATION||Q}));else if(L==="EXT-X-CUE-IN")A.markers.push(new V({type:"IN"}));else if(L==="EXT-X-CUE-OUT-CONT"||L==="EXT-X-CUE"||L==="EXT-OATCLS-SCTE35"||L==="EXT-X-ASSET"||L==="EXT-X-SCTE35")A.markers.push(new V({type:"RAW",tagName:L,value:Q}));else if(L!=="EXT-X-PRELOAD-HINT"||h.TYPE)if(L==="EXT-X-PRELOAD-HINT"&&h.TYPE==="PART"&&P)l.INVALIDPLAYLIST("Servers should not add more than one EXT-X-PRELOAD-HINT tag with the same TYPE attribute to a Playlist.");else if(L!=="EXT-X-PART"&&L!=="EXT-X-PRELOAD-HINT"||h.URI){if(L==="EXT-X-PRELOAD-HINT"&&h.TYPE==="MAP")E&&l.INVALIDPLAYLIST("Servers should not add more than one EXT-X-PRELOAD-HINT tag with the same TYPE attribute to a Playlist."),E=!0,S.hasMap=!0,A.map=new b({hint:!0,uri:h.URI,byterange:{length:h["BYTERANGE-LENGTH"],offset:h["BYTERANGE-START"]||0}});else if(L==="EXT-X-PART"||L==="EXT-X-PRELOAD-HINT"&&h.TYPE==="PART"){L!=="EXT-X-PART"||h.DURATION||l.INVALIDPLAYLIST("EXT-X-PART: DURATION attribute is mandatory"),L==="EXT-X-PRELOAD-HINT"&&(P=!0);var et=new i({hint:L==="EXT-X-PRELOAD-HINT",uri:h.URI,byterange:L==="EXT-X-PART"?h.BYTERANGE:{length:h["BYTERANGE-LENGTH"],offset:h["BYTERANGE-START"]||0},duration:h.DURATION,independent:h.INDEPENDENT,gap:h.GAP});A.parts.push(et)}}else l.INVALIDPLAYLIST("EXT-X-PART / EXT-X-PRELOAD-HINT: URI attribute is mandatory");else l.INVALIDPLAYLIST("EXT-X-PRELOAD-HINT: TYPE attribute is mandatory")}return A}function s(n,a,I,u,N,R,S){for(var A=new p({uri:a,mediaSequenceNumber:N,discontinuitySequence:R}),E=I;E<=u;E++){var P=n[E],y=P.name,M=P.attributes;y==="EXTINF"?l.INVALIDPLAYLIST("A prefetch segment must not be advertised with an EXTINF tag."):y==="EXT-X-DISCONTINUITY"?l.INVALIDPLAYLIST("A prefetch segment must not be advertised with an EXT-X-DISCONTINUITY tag."):y==="EXT-X-PREFETCH-DISCONTINUITY"?A.discontinuity=!0:y==="EXT-X-KEY"?(k(S,M),A.key=new m({method:M.METHOD,uri:M.URI,iv:M.IV,format:M.KEYFORMAT,formatVersion:M.KEYFORMATVERSIONS})):y==="EXT-X-MAP"&&l.INVALIDPLAYLIST("Prefetch segments must not be advertised with an EXT-X-MAP tag.")}return A}function v(n,a){var I,u=new ot,N=-1,R=0,S=!1,A=!1,E=0,P=null,y=null,M=!1,L=K(n.entries());try{for(L.s();!(I=L.n()).done;){var Q=W(I.value,2),h=Q[0],tt=Q[1],F=tt.name,st=tt.value,B=tt.attributes;if(tt.category!=="Segment"){if(F==="EXT-X-VERSION")u.version===void 0?u.version=st:l.INVALIDPLAYLIST("A Playlist file MUST NOT contain more than one EXT-X-VERSION tag.");else if(F==="EXT-X-TARGETDURATION")u.targetDuration=a.targetDuration=st;else if(F==="EXT-X-MEDIA-SEQUENCE")u.segments.length>0&&l.INVALIDPLAYLIST("The EXT-X-MEDIA-SEQUENCE tag MUST appear before the first Media Segment in the Playlist."),u.mediaSequenceBase=R=st;else if(F==="EXT-X-DISCONTINUITY-SEQUENCE")u.segments.length>0&&l.INVALIDPLAYLIST("The EXT-X-DISCONTINUITY-SEQUENCE tag MUST appear before the first Media Segment in the Playlist."),S&&l.INVALIDPLAYLIST("The EXT-X-DISCONTINUITY-SEQUENCE tag MUST appear before any EXT-X-DISCONTINUITY tag."),u.discontinuitySequenceBase=E=st;else if(F==="EXT-X-ENDLIST")u.endlist=!0;else if(F==="EXT-X-PLAYLIST-TYPE")u.playlistType=st;else if(F==="EXT-X-I-FRAMES-ONLY")a.compatibleVersion<4&&(a.compatibleVersion=4),u.isIFrame=!0;else if(F==="EXT-X-INDEPENDENT-SEGMENTS")u.independentSegments&&l.INVALIDPLAYLIST("EXT-X-INDEPENDENT-SEGMENTS tag MUST NOT appear more than once in a Playlist"),u.independentSegments=!0;else if(F==="EXT-X-START")u.start&&l.INVALIDPLAYLIST("EXT-X-START tag MUST NOT appear more than once in a Playlist"),typeof B["TIME-OFFSET"]!="number"&&l.INVALIDPLAYLIST("EXT-X-START: TIME-OFFSET attribute is REQUIRED"),u.start={offset:B["TIME-OFFSET"],precise:B.PRECISE||!1};else if(F==="EXT-X-SERVER-CONTROL")B["CAN-BLOCK-RELOAD"]||l.INVALIDPLAYLIST("EXT-X-SERVER-CONTROL: CAN-BLOCK-RELOAD=YES is mandatory for Low-Latency HLS"),u.lowLatencyCompatibility={canBlockReload:B["CAN-BLOCK-RELOAD"],canSkipUntil:B["CAN-SKIP-UNTIL"],holdBack:B["HOLD-BACK"],partHoldBack:B["PART-HOLD-BACK"]};else if(F==="EXT-X-PART-INF")B["PART-TARGET"]||l.INVALIDPLAYLIST("EXT-X-PART-INF: PART-TARGET attribute is mandatory"),u.partTargetDuration=B["PART-TARGET"];else if(F==="EXT-X-RENDITION-REPORT")B.URI||l.INVALIDPLAYLIST("EXT-X-RENDITION-REPORT: URI attribute is mandatory"),B.URI.search(/^[a-z]+:/)===0&&l.INVALIDPLAYLIST("EXT-X-RENDITION-REPORT: URI must be relative to the playlist uri"),u.renditionReports.push(new f({uri:B.URI,lastMSN:B["LAST-MSN"],lastPart:B["LAST-PART"]}));else if(F==="EXT-X-SKIP")B["SKIPPED-SEGMENTS"]||l.INVALIDPLAYLIST("EXT-X-SKIP: SKIPPED-SEGMENTS attribute is mandatory"),a.compatibleVersion<9&&(a.compatibleVersion=9),u.skip=B["SKIPPED-SEGMENTS"],R+=u.skip;else if(F==="EXT-X-PREFETCH"){var et=s(n,st,N===-1?h:N,h-1,R++,E,a);et&&(et.discontinuity&&(et.discontinuitySequence++,E=et.discontinuitySequence),et.key?P=et.key:et.key=P,u.prefetchSegments.push(et)),A=!0,N=-1}else if(typeof tt=="string"){N===-1&&l.INVALIDPLAYLIST("A URI line is not preceded by any segment tags"),u.targetDuration||l.INVALIDPLAYLIST("The EXT-X-TARGETDURATION tag is REQUIRED"),A&&l.INVALIDPLAYLIST("These segments must appear after all complete segments.");var ut=o(n,tt,N,h-1,R++,E,a);if(ut){var Tt=W(X(u,ut,E,P,y),3);E=Tt[0],P=Tt[1],y=Tt[2],!M&&ut.parts.length>0&&(M=!0)}N=-1}}else N===-1&&(N=h),F==="EXT-X-DISCONTINUITY"&&(S=!0)}}catch(Et){L.e(Et)}finally{L.f()}if(N!==-1){var it=o(n,"",N,n.length-1,R++,E,a);if(it){var It=it.parts;It.length>0&&!u.endlist&&!It[It.length-1].hint&&l.INVALIDPLAYLIST("If the Playlist contains EXT-X-PART tags and does not contain an EXT-X-ENDLIST tag, the Playlist must contain an EXT-X-PRELOAD-HINT tag with a TYPE=PART attribute"),X(u,it,P,y),!M&&it.parts.length>0&&(M=!0)}}return function(Et){for(var Rt=new Map,Nt=new Map,yt=!1,pt=!1,ht=Et.length-1;ht>=0;ht--){var gt=Et[ht],Ct=gt.programDateTime,$=gt.dateRange;if(Ct&&(pt=!0),$&&$.start){yt=!0,$.endOnNext&&($.end||$.duration)&&l.INVALIDPLAYLIST("An EXT-X-DATERANGE tag with an END-ON-NEXT=YES attribute MUST NOT contain DURATION or END-DATE attributes.");var ft=$.start.getTime(),Lt=$.duration||0;$.end&&$.duration&&ft+1e3*Lt!==$.end.getTime()&&l.INVALIDPLAYLIST("END-DATE MUST be equal to the value of the START-DATE attribute plus the value of the DURATION"),$.endOnNext&&($.end=Rt.get($.classId)),Rt.set($.classId,$.start);var At=$.end?$.end.getTime():$.start.getTime()+1e3*($.duration||0),mt=Nt.get($.classId);if(mt){var Dt,dt=K(mt);try{for(dt.s();!(Dt=dt.n()).done;){var St=Dt.value;(St.start<=ft&&St.end>ft||St.start>=ft&&St.start<At)&&l.INVALIDPLAYLIST("DATERANGE tags with the same CLASS should not overlap")}}catch(Xt){dt.e(Xt)}finally{dt.f()}mt.push({start:ft,end:At})}else Nt.set($.classId,[{start:ft,end:At}])}}yt&&!pt&&l.INVALIDPLAYLIST("If a Playlist contains an EXT-X-DATERANGE tag, it MUST also contain at least one EXT-X-PROGRAM-DATE-TIME tag.")}(u.segments),u.lowLatencyCompatibility&&function(Et,Rt){var Nt=Et.lowLatencyCompatibility,yt=Et.targetDuration,pt=Et.partTargetDuration,ht=Et.segments,gt=Et.renditionReports,Ct=Nt.canSkipUntil,$=Nt.holdBack,ft=Nt.partHoldBack;if(Ct<6*yt&&l.INVALIDPLAYLIST("The Skip Boundary must be at least six times the EXT-X-TARGETDURATION."),$<3*yt&&l.INVALIDPLAYLIST("HOLD-BACK must be at least three times the EXT-X-TARGETDURATION."),Rt){pt===void 0&&l.INVALIDPLAYLIST("EXT-X-PART-INF is required if a Playlist contains one or more EXT-X-PART tags"),ft===void 0&&l.INVALIDPLAYLIST("EXT-X-PART: PART-HOLD-BACK attribute is mandatory"),ft<pt&&l.INVALIDPLAYLIST("PART-HOLD-BACK must be at least PART-TARGET");var Lt,At=K(ht.entries());try{for(At.s();!(Lt=At.n()).done;){var mt=W(Lt.value,2),Dt=mt[0],dt=mt[1].parts;dt.length>0&&Dt<ht.length-3&&l.INVALIDPLAYLIST("Remove EXT-X-PART tags from the Playlist after they are greater than three target durations from the end of the Playlist.");var St,Xt=K(dt.entries());try{for(Xt.s();!(St=Xt.n()).done;){var wt=W(St.value,2),kt=wt[0],Mt=wt[1].duration;Mt!==void 0&&(Mt>pt&&l.INVALIDPLAYLIST("PART-TARGET is the maximum duration of any Partial Segment"),kt<dt.length-1&&Mt<.85*pt&&l.INVALIDPLAYLIST("All Partial Segments except the last part of a segment must have a duration of at least 85% of PART-TARGET"))}}catch(vt){Xt.e(vt)}finally{Xt.f()}}}catch(vt){At.e(vt)}finally{At.f()}}var Ft,Ot=K(gt);try{for(Ot.s();!(Ft=Ot.n()).done;){var Pt=Ft.value,Ut=ht[ht.length-1];Pt.lastMSN||(Pt.lastMSN=Ut.mediaSequenceNumber),!Pt.lastPart&&Ut.parts.length>0&&(Pt.lastPart=Ut.parts.length-1)}}catch(vt){Ot.e(vt)}finally{Ot.f()}}(u,M),u}function X(n,a,I,u,N){var R=a.discontinuity,S=a.key,A=a.map,E=a.byterange,P=a.uri;if(R&&(a.discontinuitySequence=I+1),S||(a.key=u),A||(a.map=N),E&&E.offset===-1){var y=n.segments;if(y.length>0){var M=y[y.length-1];M.byterange&&M.uri===P?E.offset=M.byterange.offset+M.byterange.length:l.INVALIDPLAYLIST("If offset of EXT-X-BYTERANGE is not present, a previous Media Segment MUST be a sub-range of the same media resource")}else l.INVALIDPLAYLIST("If offset of EXT-X-BYTERANGE is not present, a previous Media Segment MUST appear in the Playlist file")}return n.segments.push(a),[a.discontinuitySequence,a.key,a.map]}function C(n,a){var I=W(function(A){var E=A.indexOf(":");return E===-1?[A.slice(1).trim(),null]:[A.slice(1,E).trim(),A.slice(E+1).trim()]}(n),2),u=I[0],N=I[1],R=function(A){switch(A){case"EXTM3U":case"EXT-X-VERSION":return"Basic";case"EXTINF":case"EXT-X-BYTERANGE":case"EXT-X-DISCONTINUITY":case"EXT-X-PREFETCH-DISCONTINUITY":case"EXT-X-KEY":case"EXT-X-MAP":case"EXT-X-PROGRAM-DATE-TIME":case"EXT-X-DATERANGE":case"EXT-X-CUE-OUT":case"EXT-X-CUE-IN":case"EXT-X-CUE-OUT-CONT":case"EXT-X-CUE":case"EXT-OATCLS-SCTE35":case"EXT-X-ASSET":case"EXT-X-SCTE35":case"EXT-X-PART":case"EXT-X-PRELOAD-HINT":return"Segment";case"EXT-X-TARGETDURATION":case"EXT-X-MEDIA-SEQUENCE":case"EXT-X-DISCONTINUITY-SEQUENCE":case"EXT-X-ENDLIST":case"EXT-X-PLAYLIST-TYPE":case"EXT-X-I-FRAMES-ONLY":case"EXT-X-SERVER-CONTROL":case"EXT-X-PART-INF":case"EXT-X-PREFETCH":case"EXT-X-RENDITION-REPORT":case"EXT-X-SKIP":return"MediaPlaylist";case"EXT-X-MEDIA":case"EXT-X-STREAM-INF":case"EXT-X-I-FRAME-STREAM-INF":case"EXT-X-SESSION-DATA":case"EXT-X-SESSION-KEY":return"MasterPlaylist";case"EXT-X-INDEPENDENT-SEGMENTS":case"EXT-X-START":return"MediaorMasterPlaylist";default:return"Unknown"}}(u);if(function(A,E){if(A==="Segment"||A==="MediaPlaylist")return E.isMasterPlaylist===void 0?void(E.isMasterPlaylist=!1):void(E.isMasterPlaylist&&ct());if(A==="MasterPlaylist"){if(E.isMasterPlaylist===void 0)return void(E.isMasterPlaylist=!0);E.isMasterPlaylist===!1&&ct()}}(R,a),R==="Unknown")return null;R==="MediaPlaylist"&&u!=="EXT-X-RENDITION-REPORT"&&u!=="EXT-X-PREFETCH"&&(a.hash[u]&&l.INVALIDPLAYLIST("There MUST NOT be more than one Media Playlist tag of each type in any Media Playlist"),a.hash[u]=!0);var S=W(function(A,E){switch(A){case"EXTM3U":case"EXT-X-DISCONTINUITY":case"EXT-X-ENDLIST":case"EXT-X-I-FRAMES-ONLY":case"EXT-X-INDEPENDENT-SEGMENTS":case"EXT-X-CUE-IN":return[null,null];case"EXT-X-VERSION":case"EXT-X-TARGETDURATION":case"EXT-X-MEDIA-SEQUENCE":case"EXT-X-DISCONTINUITY-SEQUENCE":return[l.toNumber(E),null];case"EXT-X-CUE-OUT":return Number.isNaN(Number(E))?[null,J(E)]:[l.toNumber(E),null];case"EXT-X-KEY":case"EXT-X-MAP":case"EXT-X-DATERANGE":case"EXT-X-MEDIA":case"EXT-X-STREAM-INF":case"EXT-X-I-FRAME-STREAM-INF":case"EXT-X-SESSION-DATA":case"EXT-X-SESSION-KEY":case"EXT-X-START":case"EXT-X-SERVER-CONTROL":case"EXT-X-PART-INF":case"EXT-X-PART":case"EXT-X-PRELOAD-HINT":case"EXT-X-RENDITION-REPORT":case"EXT-X-SKIP":return[null,J(E)];case"EXTINF":return[U(E),null];case"EXT-X-BYTERANGE":return[G(E),null];case"EXT-X-PROGRAM-DATE-TIME":return[new Date(E),null];case"EXT-X-PLAYLIST-TYPE":default:return[E,null]}}(u,N),2);return{name:u,category:R,value:S[0],attributes:S[1]}}function O(n,a){var I;return a.isMasterPlaylist?I=function(u,N){var R,S=new w,A=!1,E=K(u.entries());try{for(E.s();!(R=E.n()).done;){var P=W(R.value,2),y=P[0],M=P[1],L=M.name,Q=M.value,h=M.attributes;if(L==="EXT-X-VERSION")S.version=Q;else if(L==="EXT-X-STREAM-INF"){var tt=u[y+1];(typeof tt!="string"||tt.startsWith("#EXT"))&&l.INVALIDPLAYLIST("EXT-X-STREAM-INF must be followed by a URI line");var F=e(u,h,tt,!1,N);F&&(typeof F.score=="number"&&(A=!0,F.score<0&&l.INVALIDPLAYLIST("SCORE attribute on EXT-X-STREAM-INF must be positive decimal-floating-point number.")),S.variants.push(F))}else if(L==="EXT-X-I-FRAME-STREAM-INF"){var st=e(u,h,h.URI,!0,N);st&&S.variants.push(st)}else L==="EXT-X-SESSION-DATA"?function(){var it=new D({id:h["DATA-ID"],value:h.VALUE,uri:h.URI,language:h.LANGUAGE});S.sessionDataList.some(function(It){return It.id===it.id&&It.language===it.language})&&l.INVALIDPLAYLIST("A Playlist MUST NOT contain more than one EXT-X-SESSION-DATA tag with the same DATA-ID attribute and the same LANGUAGE attribute."),S.sessionDataList.push(it)}():L==="EXT-X-SESSION-KEY"?function(){h.METHOD==="NONE"&&l.INVALIDPLAYLIST("EXT-X-SESSION-KEY: The value of the METHOD attribute MUST NOT be NONE");var it=new m({method:h.METHOD,uri:h.URI,iv:h.IV,format:h.KEYFORMAT,formatVersion:h.KEYFORMATVERSIONS});S.sessionKeyList.some(function(It){return t(It,it)})&&l.INVALIDPLAYLIST("A Master Playlist MUST NOT contain more than one EXT-X-SESSION-KEY tag with the same METHOD, URI, IV, KEYFORMAT, and KEYFORMATVERSIONS attribute values."),k(N,h),S.sessionKeyList.push(it)}():L==="EXT-X-INDEPENDENT-SEGMENTS"?(S.independentSegments&&l.INVALIDPLAYLIST("EXT-X-INDEPENDENT-SEGMENTS tag MUST NOT appear more than once in a Playlist"),S.independentSegments=!0):L==="EXT-X-START"&&(S.start&&l.INVALIDPLAYLIST("EXT-X-START tag MUST NOT appear more than once in a Playlist"),typeof h["TIME-OFFSET"]!="number"&&l.INVALIDPLAYLIST("EXT-X-START: TIME-OFFSET attribute is REQUIRED"),S.start={offset:h["TIME-OFFSET"],precise:h.PRECISE||!1})}}catch(it){E.e(it)}finally{E.f()}if(A){var B,et=K(S.variants);try{for(et.s();!(B=et.n()).done;)typeof B.value.score!="number"&&l.INVALIDPLAYLIST("If any Variant Stream contains the SCORE attribute, then all Variant Streams in the Master Playlist SHOULD have a SCORE attribute")}catch(it){et.e(it)}finally{et.f()}}if(N.isClosedCaptionsNone){var ut,Tt=K(S.variants);try{for(Tt.s();!(ut=Tt.n()).done;)ut.value.closedCaptions.length>0&&l.INVALIDPLAYLIST("If there is a variant with CLOSED-CAPTIONS attribute of NONE, all EXT-X-STREAM-INF tags MUST have this attribute with a value of NONE")}catch(it){Tt.e(it)}finally{Tt.f()}}return S}(n,a):!(I=v(n,a)).isIFrame&&a.hasMap&&a.compatibleVersion<6&&(a.compatibleVersion=6),a.compatibleVersion>1&&(!I.version||I.version<a.compatibleVersion)&&l.INVALIDPLAYLIST("EXT-X-VERSION needs to be ".concat(a.compatibleVersion," or higher.")),I}at.exports=function(n){var a={version:void 0,isMasterPlaylist:void 0,hasMap:!1,targetDuration:0,compatibleVersion:1,isClosedCaptionsNone:!1,hash:{}},I=O(function(u,N){var R,S=[],A=K(u.split(`
`));try{for(A.s();!(R=A.n()).done;){var E=R.value,P=__Buffer$.from(E.trim()).toString();if(P)if(P.startsWith("#")){if(P.startsWith("#EXT")){var y=C(P,N);y&&S.push(y)}}else S.push(P)}}catch(M){A.e(M)}finally{A.f()}return S.length!==0&&S[0].name==="EXTM3U"||l.INVALIDPLAYLIST("The EXTM3U tag MUST be the first line."),S}(n,a),a);return I.source=n,I}},367:(at,rt,x)=>{function W(e){return(W=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function K(e,t){return function(o){if(Array.isArray(o))return o}(e)||function(o,s){if(typeof Symbol<"u"&&Symbol.iterator in Object(o)){var v=[],X=!0,C=!1,O=void 0;try{for(var n,a=o[Symbol.iterator]();!(X=(n=a.next()).done)&&(v.push(n.value),!s||v.length!==s);X=!0);}catch(I){C=!0,O=I}finally{try{X||a.return==null||a.return()}finally{if(C)throw O}}return v}}(e,t)||Z(e,t)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function j(e,t){var o;if(typeof Symbol>"u"||e[Symbol.iterator]==null){if(Array.isArray(e)||(o=Z(e))||t&&e&&typeof e.length=="number"){o&&(e=o);var s=0,v=function(){};return{s:v,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(n){throw n},f:v}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var X,C=!0,O=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var n=o.next();return C=n.done,n},e:function(n){O=!0,X=n},f:function(){try{C||o.return==null||o.return()}finally{if(O)throw X}}}}function Z(e,t){if(e){if(typeof e=="string")return l(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return o==="Object"&&e.constructor&&(o=e.constructor.name),o==="Map"||o==="Set"?Array.from(e):o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?l(e,t):void 0}}function l(e,t){(t==null||t>e.length)&&(t=e.length);for(var o=0,s=new Array(t);o<t;o++)s[o]=e[o];return s}function r(e,t){for(var o=0;o<t.length;o++){var s=t[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function d(e,t,o){return(d=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(s,v,X){var C=function(n,a){for(;!Object.prototype.hasOwnProperty.call(n,a)&&(n=V(n))!==null;);return n}(s,v);if(C){var O=Object.getOwnPropertyDescriptor(C,v);return O.get?O.get.call(X):O.value}})(e,t,o||e)}function T(e,t){return!t||W(t)!=="object"&&typeof t!="function"?function(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}(e):t}function D(e){var t=typeof Map=="function"?new Map:void 0;return(D=function(o){if(o===null||(s=o,Function.toString.call(s).indexOf("[native code]")===-1))return o;var s;if(typeof o!="function")throw new TypeError("Super expression must either be null or a function");if(t!==void 0){if(t.has(o))return t.get(o);t.set(o,v)}function v(){return m(o,arguments,V(this).constructor)}return v.prototype=Object.create(o.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),Y(v,o)})(e)}function m(e,t,o){return(m=b()?Reflect.construct:function(s,v,X){var C=[null];C.push.apply(C,v);var O=new(Function.bind.apply(s,C));return X&&Y(O,X.prototype),O}).apply(null,arguments)}function b(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Y(e,t){return(Y=Object.setPrototypeOf||function(o,s){return o.__proto__=s,o})(e,t)}function V(e){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var w=x(771),ot=["#EXTINF","#EXT-X-BYTERANGE","#EXT-X-DISCONTINUITY","#EXT-X-STREAM-INF","#EXT-X-CUE-OUT","#EXT-X-CUE-IN","#EXT-X-KEY","#EXT-X-MAP"],g=["#EXT-X-MEDIA"],i=function(e){(function(n,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(a&&a.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),a&&Y(n,a)})(O,e);var t,o,s,v,X,C=(t=O,o=b(),function(){var n,a=V(t);if(o){var I=V(this).constructor;n=Reflect.construct(a,arguments,I)}else n=a.apply(this,arguments);return T(this,n)});function O(n){var a;return function(I,u){if(!(I instanceof u))throw new TypeError("Cannot call a class as a function")}(this,O),(a=C.call(this)).baseUri=n,a}return s=O,(v=[{key:"push",value:function(){for(var n=this,a=arguments.length,I=new Array(a),u=0;u<a;u++)I[u]=arguments[u];for(var N=function(){var A=S[R];if(!A.startsWith("#")||ot.some(function(E){return A.startsWith(E)}))return d(V(O.prototype),"push",n).call(n,A),"continue";if(n.includes(A)){if(g.some(function(E){return A.startsWith(E)}))return"continue";w.INVALIDPLAYLIST("Redundant item (".concat(A,")"))}d(V(O.prototype),"push",n).call(n,A)},R=0,S=I;R<S.length;R++)N()}}])&&r(s.prototype,v),X&&r(s,X),O}(D(Array));function p(e,t){var o=1e3;t&&(o=Math.pow(10,t));var s=Math.round(e*o)/o;return t?s.toFixed(t):s}function f(e){var t=e.toString(10),o=t.indexOf(".");return o===-1?0:t.length-o-1}function c(e){var t=['DATA-ID="'.concat(e.id,'"')];return e.language&&t.push('LANGUAGE="'.concat(e.language,'"')),e.value?t.push('VALUE="'.concat(e.value,'"')):e.uri&&t.push('URI="'.concat(e.uri,'"')),"#EXT-X-SESSION-DATA:".concat(t.join(","))}function U(e,t){var o=t?"#EXT-X-SESSION-KEY":"#EXT-X-KEY",s=["METHOD=".concat(e.method)];return e.uri&&s.push('URI="'.concat(e.uri,'"')),e.iv&&(e.iv.length!==16&&w.INVALIDPLAYLIST("IV must be a 128-bit unsigned integer"),s.push("IV=".concat(w.byteSequenceToHex(e.iv)))),e.format&&s.push('KEYFORMAT="'.concat(e.format,'"')),e.formatVersion&&s.push('KEYFORMATVERSIONS="'.concat(e.formatVersion,'"')),"".concat(o,":").concat(s.join(","))}function G(e,t){var o=t.isIFrameOnly?"#EXT-X-I-FRAME-STREAM-INF":"#EXT-X-STREAM-INF",s=["BANDWIDTH=".concat(t.bandwidth)];if(t.averageBandwidth&&s.push("AVERAGE-BANDWIDTH=".concat(t.averageBandwidth)),t.isIFrameOnly&&s.push('URI="'.concat(t.uri,'"')),t.codecs&&s.push('CODECS="'.concat(t.codecs,'"')),t.resolution&&s.push("RESOLUTION=".concat(t.resolution.width,"x").concat(t.resolution.height)),t.frameRate&&s.push("FRAME-RATE=".concat(p(t.frameRate,3))),t.hdcpLevel&&s.push("HDCP-LEVEL=".concat(t.hdcpLevel)),t.audio.length>0){s.push('AUDIO="'.concat(t.audio[0].groupId,'"'));var v,X=j(t.audio);try{for(X.s();!(v=X.n()).done;){var C=v.value;e.push(H(C))}}catch(h){X.e(h)}finally{X.f()}}if(t.video.length>0){s.push('VIDEO="'.concat(t.video[0].groupId,'"'));var O,n=j(t.video);try{for(n.s();!(O=n.n()).done;){var a=O.value;e.push(H(a))}}catch(h){n.e(h)}finally{n.f()}}if(t.subtitles.length>0){s.push('SUBTITLES="'.concat(t.subtitles[0].groupId,'"'));var I,u=j(t.subtitles);try{for(u.s();!(I=u.n()).done;){var N=I.value;e.push(H(N))}}catch(h){u.e(h)}finally{u.f()}}if(w.getOptions().allowClosedCaptionsNone&&t.closedCaptions.length===0)s.push("CLOSED-CAPTIONS=NONE");else if(t.closedCaptions.length>0){s.push('CLOSED-CAPTIONS="'.concat(t.closedCaptions[0].groupId,'"'));var R,S=j(t.closedCaptions);try{for(S.s();!(R=S.n()).done;){var A=R.value;e.push(H(A))}}catch(h){S.e(h)}finally{S.f()}}if(t.score&&s.push("SCORE=".concat(t.score)),t.allowedCpc){var E,P=[],y=j(t.allowedCpc);try{for(y.s();!(E=y.n()).done;){var M=E.value,L=M.format,Q=M.cpcList;P.push("".concat(L,":").concat(Q.join("/")))}}catch(h){y.e(h)}finally{y.f()}s.push('ALLOWED-CPC="'.concat(P.join(","),'"'))}t.videoRange&&s.push("VIDEO-RANGE=".concat(t.videoRange)),t.stableVariantId&&s.push('STABLE-VARIANT-ID="'.concat(t.stableVariantId,'"')),e.push("".concat(o,":").concat(s.join(","))),t.isIFrameOnly||e.push("".concat(t.uri))}function H(e){var t=["TYPE=".concat(e.type),'GROUP-ID="'.concat(e.groupId,'"'),'NAME="'.concat(e.name,'"')];return e.isDefault!==void 0&&t.push("DEFAULT=".concat(e.isDefault?"YES":"NO")),e.autoselect!==void 0&&t.push("AUTOSELECT=".concat(e.autoselect?"YES":"NO")),e.forced!==void 0&&t.push("FORCED=".concat(e.forced?"YES":"NO")),e.language&&t.push('LANGUAGE="'.concat(e.language,'"')),e.assocLanguage&&t.push('ASSOC-LANGUAGE="'.concat(e.assocLanguage,'"')),e.instreamId&&t.push('INSTREAM-ID="'.concat(e.instreamId,'"')),e.characteristics&&t.push('CHARACTERISTICS="'.concat(e.characteristics,'"')),e.channels&&t.push('CHANNELS="'.concat(e.channels,'"')),e.uri&&t.push('URI="'.concat(e.uri,'"')),"#EXT-X-MEDIA:".concat(t.join(","))}function q(e,t,o,s){var v=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,X=!1,C="";if(t.discontinuity&&e.push("#EXT-X-DISCONTINUITY"),t.key){var O=U(t.key);O!==o&&(e.push(O),o=O)}if(t.map){var n=_(t.map);n!==s&&(e.push(n),s=n)}if(t.programDateTime&&e.push("#EXT-X-PROGRAM-DATE-TIME:".concat(w.formatDate(t.programDateTime))),t.dateRange&&e.push(J(t.dateRange)),t.markers.length>0&&(C=ct(e,t.markers)),t.parts.length>0&&(X=lt(e,t.parts)),X)return[o,s];var a=v<3?Math.round(t.duration):p(t.duration,f(t.duration));return e.push("#EXTINF:".concat(a,",").concat(unescape(encodeURIComponent(t.title||"")))),t.byterange&&e.push("#EXT-X-BYTERANGE:".concat(k(t.byterange))),Array.prototype.push.call(e,"".concat(t.uri)),[o,s,C]}function _(e){var t=['URI="'.concat(e.uri,'"')];return e.byterange&&t.push('BYTERANGE="'.concat(k(e.byterange),'"')),"#EXT-X-MAP:".concat(t.join(","))}function k(e){var t=e.offset,o=e.length;return"".concat(o,"@").concat(t)}function J(e){var t=['ID="'.concat(e.id,'"')];e.start&&t.push('START-DATE="'.concat(w.formatDate(e.start),'"')),e.end&&t.push('END-DATE="'.concat(e.end,'"')),e.duration&&t.push("DURATION=".concat(e.duration)),e.plannedDuration&&t.push("PLANNED-DURATION=".concat(e.plannedDuration)),e.classId&&t.push('CLASS="'.concat(e.classId,'"')),e.endOnNext&&t.push("END-ON-NEXT=YES");for(var o=0,s=Object.keys(e.attributes);o<s.length;o++){var v=s[o];v.startsWith("X-")?typeof e.attributes[v]=="number"?t.push("".concat(v,"=").concat(e.attributes[v])):t.push("".concat(v,'="').concat(e.attributes[v],'"')):v.startsWith("SCTE35-")&&t.push("".concat(v,"=").concat(w.byteSequenceToHex(e.attributes[v])))}return"#EXT-X-DATERANGE:".concat(t.join(","))}function ct(e,t){var o,s="",v=j(t);try{for(v.s();!(o=v.n()).done;){var X=o.value;if(X.type==="OUT")s="OUT",e.push("#EXT-X-CUE-OUT:DURATION=".concat(X.duration));else if(X.type==="IN")s="IN",e.push("#EXT-X-CUE-IN");else if(X.type==="RAW"){var C=X.value?":".concat(X.value):"";e.push("#".concat(X.tagName).concat(C))}}}catch(O){v.e(O)}finally{v.f()}return s}function lt(e,t){var o,s=!1,v=j(t);try{for(v.s();!(o=v.n()).done;){var X=o.value;if(X.hint){var C=[];if(C.push("TYPE=PART",'URI="'.concat(X.uri,'"')),X.byterange){var O=X.byterange,n=O.offset,a=O.length;C.push("BYTERANGE-START=".concat(n)),a&&C.push("BYTERANGE-LENGTH=".concat(a))}e.push("#EXT-X-PRELOAD-HINT:".concat(C.join(","))),s=!0}else{var I=[];I.push("DURATION=".concat(X.duration),'URI="'.concat(X.uri,'"')),X.byterange&&I.push("BYTERANGE=".concat(k(X.byterange))),X.independent&&I.push("INDEPENDENT=YES"),X.gap&&I.push("GAP=YES"),e.push("#EXT-X-PART:".concat(I.join(",")))}}}catch(u){v.e(u)}finally{v.f()}return s}at.exports=function(e){w.PARAMCHECK(e),w.ASSERT("Not a playlist",e.type==="playlist");var t=new i(e.uri);return t.push("#EXTM3U"),e.version&&t.push("#EXT-X-VERSION:".concat(e.version)),e.independentSegments&&t.push("#EXT-X-INDEPENDENT-SEGMENTS"),e.start&&t.push("#EXT-X-START:TIME-OFFSET=".concat(p(e.start.offset)).concat(e.start.precise?",PRECISE=YES":"")),e.isMasterPlaylist?function(o,s){var v,X=j(s.sessionDataList);try{for(X.s();!(v=X.n()).done;){var C=v.value;o.push(c(C))}}catch(N){X.e(N)}finally{X.f()}var O,n=j(s.sessionKeyList);try{for(n.s();!(O=n.n()).done;){var a=O.value;o.push(U(a,!0))}}catch(N){n.e(N)}finally{n.f()}var I,u=j(s.variants);try{for(u.s();!(I=u.n()).done;)G(o,I.value)}catch(N){u.e(N)}finally{u.f()}}(t,e):function(o,s){var v="",X="",C=!1;if(s.targetDuration&&o.push("#EXT-X-TARGETDURATION:".concat(s.targetDuration)),s.lowLatencyCompatibility){var O=s.lowLatencyCompatibility,n=O.canBlockReload,a=O.canSkipUntil,I=O.holdBack,u=O.partHoldBack,N=[];N.push("CAN-BLOCK-RELOAD=".concat(n?"YES":"NO")),a!==void 0&&N.push("CAN-SKIP-UNTIL=".concat(a)),I!==void 0&&N.push("HOLD-BACK=".concat(I)),u!==void 0&&N.push("PART-HOLD-BACK=".concat(u)),o.push("#EXT-X-SERVER-CONTROL:".concat(N.join(",")))}s.partTargetDuration&&o.push("#EXT-X-PART-INF:PART-TARGET=".concat(s.partTargetDuration)),s.mediaSequenceBase&&o.push("#EXT-X-MEDIA-SEQUENCE:".concat(s.mediaSequenceBase)),s.discontinuitySequenceBase&&o.push("#EXT-X-DISCONTINUITY-SEQUENCE:".concat(s.discontinuitySequenceBase)),s.playlistType&&o.push("#EXT-X-PLAYLIST-TYPE:".concat(s.playlistType)),s.isIFrame&&o.push("#EXT-X-I-FRAMES-ONLY"),s.skip>0&&o.push("#EXT-X-SKIP:SKIPPED-SEGMENTS=".concat(s.skip));var R,S=j(s.segments);try{for(S.s();!(R=S.n()).done;){var A,E=K(q(o,R.value,v,X,s.version),3);v=E[0],X=E[1],(A=E[2])==="OUT"?C=!0:A==="IN"&&C&&(C=!1)}}catch(F){S.e(F)}finally{S.f()}s.playlistType==="VOD"&&C&&o.push("#EXT-X-CUE-IN"),s.prefetchSegments.length>2&&w.INVALIDPLAYLIST("The server must deliver no more than two prefetch segments");var P,y=j(s.prefetchSegments);try{for(y.s();!(P=y.n()).done;){var M=P.value;M.discontinuity&&o.push("#EXT-X-PREFETCH-DISCONTINUITY"),o.push("#EXT-X-PREFETCH:".concat(M.uri))}}catch(F){y.e(F)}finally{y.f()}s.endlist&&o.push("#EXT-X-ENDLIST");var L,Q=j(s.renditionReports);try{for(Q.s();!(L=Q.n()).done;){var h=L.value,tt=[];tt.push('URI="'.concat(h.uri,'"'),"LAST-MSN=".concat(h.lastMSN)),h.lastPart!==void 0&&tt.push("LAST-PART=".concat(h.lastPart)),o.push("#EXT-X-RENDITION-REPORT:".concat(tt.join(",")))}}catch(F){Q.e(F)}finally{Q.f()}}(t,e),t.join(`
`)}},890:(at,rt,x)=>{function W(g){return(W=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(g)}function K(g,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");g.prototype=Object.create(i&&i.prototype,{constructor:{value:g,writable:!0,configurable:!0}}),i&&j(g,i)}function j(g,i){return(j=Object.setPrototypeOf||function(p,f){return p.__proto__=f,p})(g,i)}function Z(g){var i=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var p,f=r(g);if(i){var c=r(this).constructor;p=Reflect.construct(f,arguments,c)}else p=f.apply(this,arguments);return l(this,p)}}function l(g,i){return!i||W(i)!=="object"&&typeof i!="function"?function(p){if(p===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p}(g):i}function r(g){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)})(g)}function d(g,i){if(!(g instanceof i))throw new TypeError("Cannot call a class as a function")}var T=x(771),D=function g(i){d(this,g),T.PARAMCHECK(i),this.type=i},m=function(g){K(p,g);var i=Z(p);function p(f){var c,U=f.isMasterPlaylist,G=f.uri,H=f.version,q=f.independentSegments,_=q!==void 0&&q,k=f.start,J=f.source;return d(this,p),c=i.call(this,"playlist"),T.PARAMCHECK(U),c.isMasterPlaylist=U,c.uri=G,c.version=H,c.independentSegments=_,c.start=k,c.source=J,c}return p}(D),b=function(g){K(p,g);var i=Z(p);function p(){var f,c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};d(this,p),c.isMasterPlaylist=!0,f=i.call(this,c);var U=c.variants,G=U===void 0?[]:U,H=c.currentVariant,q=c.sessionDataList,_=q===void 0?[]:q,k=c.sessionKeyList,J=k===void 0?[]:k;return f.variants=G,f.currentVariant=H,f.sessionDataList=_,f.sessionKeyList=J,f}return p}(m),Y=function(g){K(p,g);var i=Z(p);function p(){var f,c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};d(this,p),c.isMasterPlaylist=!1,f=i.call(this,c);var U=c.targetDuration,G=c.mediaSequenceBase,H=G===void 0?0:G,q=c.discontinuitySequenceBase,_=q===void 0?0:q,k=c.endlist,J=k!==void 0&&k,ct=c.playlistType,lt=c.isIFrame,e=c.segments,t=e===void 0?[]:e,o=c.prefetchSegments,s=o===void 0?[]:o,v=c.lowLatencyCompatibility,X=c.partTargetDuration,C=c.renditionReports,O=C===void 0?[]:C,n=c.skip,a=n===void 0?0:n,I=c.hash;return f.targetDuration=U,f.mediaSequenceBase=H,f.discontinuitySequenceBase=_,f.endlist=J,f.playlistType=ct,f.isIFrame=lt,f.segments=t,f.prefetchSegments=s,f.lowLatencyCompatibility=v,f.partTargetDuration=X,f.renditionReports=O,f.skip=a,f.hash=I,f}return p}(m),V=function(g){K(p,g);var i=Z(p);function p(f){var c,U=f.uri,G=f.mimeType,H=f.data,q=f.duration,_=f.title,k=f.byterange,J=f.discontinuity,ct=f.mediaSequenceNumber,lt=ct===void 0?0:ct,e=f.discontinuitySequence,t=e===void 0?0:e,o=f.key,s=f.map,v=f.programDateTime,X=f.dateRange,C=f.markers,O=C===void 0?[]:C,n=f.parts,a=n===void 0?[]:n;return d(this,p),(c=i.call(this,"segment")).uri=U,c.mimeType=G,c.data=H,c.duration=q,c.title=_,c.byterange=k,c.discontinuity=J,c.mediaSequenceNumber=lt,c.discontinuitySequence=t,c.key=o,c.map=s,c.programDateTime=v,c.dateRange=X,c.markers=O,c.parts=a,c}return p}(D),w=function(g){K(p,g);var i=Z(p);function p(f){var c,U=f.hint,G=U!==void 0&&U,H=f.uri,q=f.duration,_=f.independent,k=f.byterange,J=f.gap;return d(this,p),c=i.call(this,"part"),T.PARAMCHECK(H),c.hint=G,c.uri=H,c.duration=q,c.independent=_,c.duration=q,c.byterange=k,c.gap=J,c}return p}(D),ot=function(g){K(p,g);var i=Z(p);function p(f){var c,U=f.uri,G=f.discontinuity,H=f.mediaSequenceNumber,q=H===void 0?0:H,_=f.discontinuitySequence,k=_===void 0?0:_,J=f.key;return d(this,p),c=i.call(this,"prefetch"),T.PARAMCHECK(U),c.uri=U,c.discontinuity=G,c.mediaSequenceNumber=q,c.discontinuitySequence=k,c.key=J,c}return p}(D);at.exports={Rendition:function g(i){var p=i.type,f=i.uri,c=i.groupId,U=i.language,G=i.assocLanguage,H=i.name,q=i.isDefault,_=i.autoselect,k=i.forced,J=i.instreamId,ct=i.characteristics,lt=i.channels;d(this,g),T.PARAMCHECK(p,c,H),T.CONDITIONALASSERT([p==="SUBTITLES",f],[p==="CLOSED-CAPTIONS",J],[p==="CLOSED-CAPTIONS",!f],[k,p==="SUBTITLES"]),this.type=p,this.uri=f,this.groupId=c,this.language=U,this.assocLanguage=G,this.name=H,this.isDefault=q,this.autoselect=_,this.forced=k,this.instreamId=J,this.characteristics=ct,this.channels=lt},Variant:function g(i){var p=i.uri,f=i.isIFrameOnly,c=f!==void 0&&f,U=i.bandwidth,G=i.averageBandwidth,H=i.score,q=i.codecs,_=i.resolution,k=i.frameRate,J=i.hdcpLevel,ct=i.allowedCpc,lt=i.videoRange,e=i.stableVariantId,t=i.audio,o=t===void 0?[]:t,s=i.video,v=s===void 0?[]:s,X=i.subtitles,C=X===void 0?[]:X,O=i.closedCaptions,n=O===void 0?[]:O,a=i.currentRenditions,I=a===void 0?{audio:0,video:0,subtitles:0,closedCaptions:0}:a;d(this,g),T.PARAMCHECK(p,U),this.uri=p,this.isIFrameOnly=c,this.bandwidth=U,this.averageBandwidth=G,this.score=H,this.codecs=q,this.resolution=_,this.frameRate=k,this.hdcpLevel=J,this.allowedCpc=ct,this.videoRange=lt,this.stableVariantId=e,this.audio=o,this.video=v,this.subtitles=C,this.closedCaptions=n,this.currentRenditions=I},SessionData:function g(i){var p=i.id,f=i.value,c=i.uri,U=i.language;d(this,g),T.PARAMCHECK(p,f||c),T.ASSERT("SessionData cannot have both value and uri, shoud be either.",!(f&&c)),this.id=p,this.value=f,this.uri=c,this.language=U},Key:function g(i){var p=i.method,f=i.uri,c=i.iv,U=i.format,G=i.formatVersion;d(this,g),T.PARAMCHECK(p),T.CONDITIONALPARAMCHECK([p!=="NONE",f]),T.CONDITIONALASSERT([p==="NONE",!(f||c||U||G)]),this.method=p,this.uri=f,this.iv=c,this.format=U,this.formatVersion=G},MediaInitializationSection:function g(i){var p=i.hint,f=p!==void 0&&p,c=i.uri,U=i.mimeType,G=i.byterange;d(this,g),T.PARAMCHECK(c),this.hint=f,this.uri=c,this.mimeType=U,this.byterange=G},DateRange:function g(i){var p=i.id,f=i.classId,c=i.start,U=i.end,G=i.duration,H=i.plannedDuration,q=i.endOnNext,_=i.attributes,k=_===void 0?{}:_;d(this,g),T.PARAMCHECK(p),T.CONDITIONALPARAMCHECK([q===!0,f]),T.CONDITIONALASSERT([U,c],[U,c<=U],[G,G>=0],[H,H>=0]),this.id=p,this.classId=f,this.start=c,this.end=U,this.duration=G,this.plannedDuration=H,this.endOnNext=q,this.attributes=k},SpliceInfo:function g(i){var p=i.type,f=i.duration,c=i.tagName,U=i.value;d(this,g),T.PARAMCHECK(p),T.CONDITIONALPARAMCHECK([p==="OUT",f]),T.CONDITIONALPARAMCHECK([p==="RAW",c]),this.type=p,this.duration=f,this.tagName=c,this.value=U},Playlist:m,MasterPlaylist:b,MediaPlaylist:Y,Segment:V,PartialSegment:w,PrefetchSegment:ot,RenditionReport:function g(i){var p=i.uri,f=i.lastMSN,c=i.lastPart;d(this,g),T.PARAMCHECK(p),this.uri=p,this.lastMSN=f,this.lastPart=c}}},771:at=>{function rt(r,d){return function(T){if(Array.isArray(T))return T}(r)||function(T,D){if(typeof Symbol<"u"&&Symbol.iterator in Object(T)){var m=[],b=!0,Y=!1,V=void 0;try{for(var w,ot=T[Symbol.iterator]();!(b=(w=ot.next()).done)&&(m.push(w.value),!D||m.length!==D);b=!0);}catch(g){Y=!0,V=g}finally{try{b||ot.return==null||ot.return()}finally{if(Y)throw V}}return m}}(r,d)||W(r,d)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function x(r,d){var T;if(typeof Symbol>"u"||r[Symbol.iterator]==null){if(Array.isArray(r)||(T=W(r))||d&&r&&typeof r.length=="number"){T&&(r=T);var D=0,m=function(){};return{s:m,n:function(){return D>=r.length?{done:!0}:{done:!1,value:r[D++]}},e:function(w){throw w},f:m}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var b,Y=!0,V=!1;return{s:function(){T=r[Symbol.iterator]()},n:function(){var w=T.next();return Y=w.done,w},e:function(w){V=!0,b=w},f:function(){try{Y||T.return==null||T.return()}finally{if(V)throw b}}}}function W(r,d){if(r){if(typeof r=="string")return K(r,d);var T=Object.prototype.toString.call(r).slice(8,-1);return T==="Object"&&r.constructor&&(T=r.constructor.name),T==="Map"||T==="Set"?Array.from(r):T==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(T)?K(r,d):void 0}}function K(r,d){(d==null||d>r.length)&&(d=r.length);for(var T=0,D=new Array(d);T<d;T++)D[T]=r[T];return D}var j={};function Z(r){if(j.strictMode)throw r;j.silent||console.error(r.message)}function l(r){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:10;if(typeof r=="number")return r;var T=d===10?Number.parseFloat(r,d):Number.parseInt(r,d);return Number.isNaN(T)?0:T}at.exports={THROW:Z,ASSERT:function(r){for(var d=arguments.length,T=new Array(d>1?d-1:0),D=1;D<d;D++)T[D-1]=arguments[D];var m,b=x(T.entries());try{for(b.s();!(m=b.n()).done;){var Y=rt(m.value,2),V=Y[0],w=Y[1];w||Z(new Error("".concat(r," : Failed at [").concat(V,"]")))}}catch(ot){b.e(ot)}finally{b.f()}},CONDITIONALASSERT:function(){for(var r=arguments.length,d=new Array(r),T=0;T<r;T++)d[T]=arguments[T];var D,m=x(d.entries());try{for(m.s();!(D=m.n()).done;){var b=rt(D.value,2),Y=b[0],V=rt(b[1],2),w=V[0],ot=V[1];w&&(ot||Z(new Error("Conditional Assert : Failed at [".concat(Y,"]"))))}}catch(g){m.e(g)}finally{m.f()}},PARAMCHECK:function(){for(var r=arguments.length,d=new Array(r),T=0;T<r;T++)d[T]=arguments[T];var D,m=x(d.entries());try{for(m.s();!(D=m.n()).done;){var b=rt(D.value,2),Y=b[0],V=b[1];V===void 0&&Z(new Error("Param Check : Failed at [".concat(Y,"]")))}}catch(w){m.e(w)}finally{m.f()}},CONDITIONALPARAMCHECK:function(){for(var r=arguments.length,d=new Array(r),T=0;T<r;T++)d[T]=arguments[T];var D,m=x(d.entries());try{for(m.s();!(D=m.n()).done;){var b=rt(D.value,2),Y=b[0],V=rt(b[1],2),w=V[0],ot=V[1];w&&ot===void 0&&Z(new Error("Conditional Param Check : Failed at [".concat(Y,"]")))}}catch(g){m.e(g)}finally{m.f()}},INVALIDPLAYLIST:function(r){Z(new Error("Invalid Playlist : ".concat(r)))},toNumber:l,hexToByteSequence:function(r){(r.startsWith("0x")||r.startsWith("0X"))&&(r=r.slice(2));for(var d=[],T=0;T<r.length;T+=2)d.push(l(r.slice(T,T+2),16));return __Buffer$.from(d)},byteSequenceToHex:function(r){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r.length;T<=d&&Z(new Error("end must be larger than start : start=".concat(d,", end=").concat(T)));for(var D=[],m=d;m<T;m++)D.push("0".concat((255&r[m]).toString(16).toUpperCase()).slice(-2));return"0x".concat(D.join(""))},tryCatch:function(r,d){try{return r()}catch(T){return d(T)}},splitAt:function(r,d){for(var T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,D=-1,m=0,b=0;m<r.length;m++)if(r[m]===d){if(b++===T)return[r.slice(0,m),r.slice(m+1)];D=m}return D!==-1?[r.slice(0,D),r.slice(D+1)]:[r]},trim:function(r){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return r&&(r=r.trim(),d===" "||(r.startsWith(d)&&(r=r.slice(1)),r.endsWith(d)&&(r=r.slice(0,-1))),r)},splitByCommaWithPreservingQuotes:function(r){for(var d=[],T=!0,D=0,m=[],b=0;b<r.length;b++){var Y=r[b];T&&Y===","?(d.push(r.slice(D,b).trim()),D=b+1):Y!=='"'&&Y!=="'"||(T?(m.push(Y),T=!1):Y===m[m.length-1]?(m.pop(),T=!0):m.push(Y))}return d.push(r.slice(D).trim()),d},camelify:function(r){var d,T=[],D=!1,m=x(r);try{for(m.s();!(d=m.n()).done;){var b=d.value;b!=="-"&&b!=="_"?D?(T.push(b.toUpperCase()),D=!1):T.push(b.toLowerCase()):D=!0}}catch(Y){m.e(Y)}finally{m.f()}return T.join("")},formatDate:function(r){var d=r.getUTCFullYear(),T=("0"+(r.getUTCMonth()+1)).slice(-2),D=("0"+r.getUTCDate()).slice(-2),m=("0"+r.getUTCHours()).slice(-2),b=("0"+r.getUTCMinutes()).slice(-2),Y=("0"+r.getUTCSeconds()).slice(-2),V=("00"+r.getUTCMilliseconds()).slice(-3);return"".concat(d,"-").concat(T,"-").concat(D,"T").concat(m,":").concat(b,":").concat(Y,".").concat(V,"Z")},hasOwnProp:function(r,d){return Object.hasOwnProperty.call(r,d)},setOptions:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};j=Object.assign(j,r)},getOptions:function(){return Object.assign({},j)}}}},z={},function at(rt){var x=z[rt];if(x!==void 0)return x.exports;var W=z[rt]={exports:{}};return nt[rt](W,W.exports,at),W.exports}(851);var nt,z})});var Bt=Ht(Vt()),Kt=Ht(Vt()),{parse:te,stringify:ee,types:ne,getOptions:ae,setOptions:re}=Kt,{default:zt,...Zt}=Kt,ie=Bt.default??zt??Zt;export{ie as default,ae as getOptions,te as parse,re as setOptions,ee as stringify,ne as types};
/*! For license information please see hls-parser.min.js.LICENSE.txt */
